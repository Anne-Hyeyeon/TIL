# 2023-04-04

## 게시판 필터 유지 기능에 대해서
### 문제 : 게시글을 한번 클릭하고 뒤로 가기를 누를 때마다 필터와 검색어가 초기화 됨. 
- 작년 12월에 개발한 게시판. 내가 구현한 메인 파트에 문제가 생겼다. 게시글을 한번 누르고 다시 돌아올 때마다 필터가 초기화 되어버린다는 것.
- 다른 사이트의 게시판 (롤 인벤, 디씨인사이드 등)을 확인해보았다. 다른 게시판의 경우, 게시글을 클릭한 후 뒤로 가기를 눌러 목록으로 돌아와도 필터가 초기화되지 않았다. 검색어 역시 그대로 유지되었다.
- 내가 게발한 게시판의 필터는 상태 관리 라이브러리가 아닌, 컴포넌트 내부에서 **useReducer** 훅을 이용해 구현한 것이다. 보통 필터가 유지되는 게시판의 경우, 필터 값과 검색어 값이 전역에서 관리된다고 한다. 로딩 때 스토어에 있는 값을 가져오기 때문에 초기화가 되지 않는 것.
- 지피티한테 방법을 물어보았다.
```js
브라우저 내장 기능 사용
브라우저의 내장 기능인 history.pushState() 를 사용하여 URL을 변경할 수 있습니다. 이를 이용하면 뒤로 가기를 했을 때도 이전 상태를 유지할 수 있습니다. 예를 들어, 게시글을 클릭했을 때 필터 정보와 함께 URL을 변경하여 이를 유지할 수 있습니다.

쿠키 또는 로컬 스토리지 사용
쿠키 또는 로컬 스토리지에 필터 정보를 저장하여, 게시글을 클릭했다가 뒤로 가기를 하더라도 정보를 유지할 수 있습니다. 이 방법은 브라우저가 닫히거나, 사용자가 직접 삭제하지 않는 이상 정보가 계속 유지됩니다.

상태 관리 라이브러리 사용
React 등의 상태 관리 라이브러리를 사용하여 필터 정보를 상태로 관리하면, 클릭 이벤트에 따라 상태를 업데이트하고 이를 유지할 수 있습니다. 이 방법은 상태 관리 라이브러리를 사용하는 애플리케이션에서 일반적으로 사용됩니다.

이 중 어떤 방법을 선택하느냐는 애플리케이션의 구조와 개발자의 개인적인 취향에 따라 다를 수 있습니다.
```
- 결국 방법은 상태 관리 라이브러리 사용밖에 없다는 결론을 내리고, 구현했던 게시판 필터와 검색창을 다시 만들어보기로 함.

# 2023-04-06
## 게시판 필터 상태 전역 관리로 변경 
### 결국 필터를 리덕스를 이용해 관리하기로 했다. 필터를 전역관리 하면 페이지를 왔다갔다 해도 필터나 검색조건이 풀리지 않음! 
1. slice 이름과 위치 정하기 
- 관리되는 데이터는 검색어, 필터조건, 글 타입(공지, F&Q, 자료 등), 정렬 등 페이지를 나갔다 들어와도 유지되어야 하는 값. 슬라이스 이름을 어떻게 붙일까? 하다가 searchSettings로 정함. 

2. 데이터 이관작업
- 컴포넌트 내에서 useReducer와 initialState를 이용해 관리되는 값 중 searchSettings에 넣어야 하는 아이들을 데리고 옴.
- 타입 선언 
- 초기값 설정


3. 리듀서 만들기
- 앞 컴포넌트에 있는 action들을 slice의 리듀서로 하나하나 만들어 줌.

4. 기존 setState로 되어있던 값들 dispatch로 바꾸어 줌!

5. 잘 동작함

### 문제점

- 홈 버튼 눌렀을 때는 모든 조건이 해제된 순수 메인 페이지가 보여져야 하는데, '뒤로 가기'를 눌렀을 때와 동일하게 동작함. 
- 게시글 안에 있는 또다른 게시글들이 터져버림 (글이 가지고 있는 offset때문에... )

내일 목표는 이 두 가지 문제를 모두 해결하는 것이다.
